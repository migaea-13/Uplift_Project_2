<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <link rel="icon" href="https://i.ibb.co/F57MGN0/ai-1.png" type="image/png">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

  <nav id="sidebar">
    <ul>
      <li>
        <span class="logo">SubmeterWise</span>
        <button onclick=toggleSidebar()  id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm280-80h280v-560H480v560Z"/></svg>
        </button>
      </li>
      <li class="active">
        <a href="index.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M320-240h60v-80h80v-60h-80v-80h-60v80h-80v60h80v80Zm200-30h200v-60H520v60Zm0-100h200v-60H520v60Zm44-152 56-56 56 56 42-42-56-58 56-56-42-42-56 56-56-56-42 42 56 56-56 58 42 42Zm-314-70h200v-60H250v60Zm-50 472q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"/></svg>
          <span>Home</span>
        </a>
      </li>
      <li>
        <a href="about.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg>
          <span>About</span>
        </a>
      </li>
      

      <li>
        <a href="chat.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M320-520q17 0 28.5-11.5T360-560q0-17-11.5-28.5T320-600q-17 0-28.5 11.5T280-560q0 17 11.5 28.5T320-520Zm160 0q17 0 28.5-11.5T520-560q0-17-11.5-28.5T480-600q-17 0-28.5 11.5T440-560q0 17 11.5 28.5T480-520Zm160 0q17 0 28.5-11.5T680-560q0-17-11.5-28.5T640-600q-17 0-28.5 11.5T600-560q0 17 11.5 28.5T640-520ZM80-80v-720q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240L80-80Zm126-240h594v-480H160v525l46-45Zm-46 0v-480 480Z"/></svg>
          <span>Chat With AI</span>
        </a>
      </li>

    </ul>
  </nav>

  <main>

    <div class="container">
      <!-- Header -->
    <div class="header">
      <img src="https://i.ibb.co/F57MGN0/ai-1.png" alt="Chatbot Logo">
  </div>

  <!-- Chat Container -->
  <div id="chatContainer" class="chat-container"></div>

  <!-- "How Calculation Works" Button -->
  <button id="howCalculationWorks" class="info-btn">How the Calculation Works</button>

  <!-- Footer -->
  <div class="footer">
    <input type="text" id="text" placeholder="Ask me anything" autocomplete="off" required>
    <input type="file" id="fileInput" style="display: none;" accept="image/*">
    <button id="attachment">
        <i class="fas fa-paperclip"></i>
    </button>
    <button id="send">
      <i class="fas fa-location-arrow"></i>
    </button>
  </div>
    </div>
  </main>
    
<style>

@import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');

:root {
  --base-clr: #11121a;
  --line-clr: #42434a;
  --hover-clr: #222533;
  --text-clr: #e6e6ef;
  --accent-clr: #5e63ff;
  --secondary-text-clr: #b0b3c1;
}

* {
  margin: 0;
  padding: 0;
  /* box-sizing: border-box; */
}

html {
  font-family: "Poppins";
  line-height: 1.5rem;
}

body {
  min-height: 100vh;
  min-height: 100dvh;
  background-color: var(--base-clr);
  color: var(--text-clr);
  display: grid;
  grid-template-columns: auto 1fr;
}

main {
  padding: min(30px, 7%);
}

main p{
  color: var(--secondary-text-clr);
  margin-top: 5px;
  margin-bottom: 15px;
}

.container {
  border: 1px solid var(--line-clr);
  border-radius: 1em;
  margin-top: 20px;
  margin-bottom: 15px;
  padding: min(3em, 15%);
  /* background-color: ; */
  h2, p {
    margin-top: 1em;
  }
}

#sidebar {
  box-sizing: border-box;
  height: 100vh;
  width: 250px;
  padding: 5px 1em;
  background-color: var(--base-clr);
  border-right: 1px solid var(--line-clr);
  position: sticky;
  top: 0;
  align-self: start;
  transition: 300ms ease-in-out;
  overflow:hidden;
  text-wrap: no wrap;
}

#sidebar.close {
  padding: 5px;
  width: 60px;

}

#sidebar ul {
  list-style: none;
}

#sidebar > ul > li:first-child{
  display: flex;
  justify-content: flex-end;
  margin-bottom: 16px;
  .logo {
    font-weight: 600;
  }
}

#sidebar ul li.active a {
  color: var(--accent-clr);
  svg{
    fill: var(--accent-clr)
  }
}

#sidebar a, #sidebar .logo {
  border-radius: .5em;
  padding: .85em;
  text-decoration: none;
  color: var(--text-clr);
  display: flex;
  align-items: center;
  gap: 1em;
}

#sidebar svg {
  flex-shrink: 0;
  fill: var(--text-clr)
}

#sidebar a:hover {
  background-color: var(--hover-clr);
}
#sidebar a span {
  flex-grow: 1;
}

#toggle-btn {
  margin-left: auto;
  padding: 1em;
  border: none;
  border-radius: .5em;
  background: none;
  cursor: pointer;
}

#toggle-btn:hover {
  background-color: var(--hover-clr);
}


@media(max-width: 800px) {
  body {
    grid-template-columns: 1fr;
  }
  main {
    padding: 2em 1em 60px 1em;
  }
  .container {
    border: none;
    padding: 0;
  }
  #sidebar {
    height: 60px;
    width: 100%;
    border-right: none;
    border-top: 1px solid var(--line-clr);
    padding: 0;
    position: fixed;
    top: unset;
    bottom: 0;

    > ul {
      padding: 0;
      display: grid;
      grid-auto-columns: 60px;
      grid-auto-flow: column;
      align-items: center;
      /* overflow-x: scroll; */
    }
    ul li {
      height: 100%;
    }
    ul a {
      width: 60px;
      height: 60px;
      padding: 0;
      border-radius: 0;
      justify-content: center;
    }


    ul li span, ul li:first-child {
      display: none;
    }
  }
}

#submeterContainer {
  margin-top: 15px;
}

.submeter {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.submeter input {
  flex: 1;
  width: 40%;
}

#toggle-btn {
  margin-left: auto;
  padding: 1em;
  border: none;
  border-radius: .5em;
  background: none;
  cursor: pointer;
}

#toggle-btn:hover {
  background-color: var(--hover-clr);
}
#toggle-btn {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  background-color: var(--base-clr);
  color: white;
  font-size: 16px;
}

#toggle-btn:hover {
  background-color: var(--hover-clr);
}

  .info-btn {
  background-color: #406340;
  color: #ffffff;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  width: auto;
  margin: 15px auto;
  display: block;
  text-align: center;
}

.info-btn:hover {
  background-color: #2a4728;
}



/* body, html {
  height: 100%;
  margin: 0;
  background-color: #121212;
  color: #ffffff;
  font-family: 'Arial', sans-serif;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
} */

.header {
  text-align: center;
  padding: 15px 0;
}

.header img {
  height: 50px;
  width: auto;
}

.chat-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 20px;
  overflow-y: auto;
  gap: 10px;
}

.message {
  display: flex;
  align-items: flex-start;
  max-width: 70%;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.message.user {
  align-self: flex-end;
  text-align: right;
  flex-direction: row-reverse;
}

.message.model {
  align-self: flex-start;
  text-align: left;
  flex-direction: row;
}

.message .msg-body {
  font-size: 16px;
  padding: 10px;
  border-radius: 10px;
  background-color: #1e1e1e;
  color: #ffffff;
  line-height: 1.5;
  white-space: pre-wrap;
}

.message.model .msg-body {
  background: none;
}

.footer {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 15px;
  background-color: #2a2a2a;
  border-top: 1px solid #444;
  margin: 0 60px;
  border-radius: 20px;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.4);
  gap: 5px;
}

.footer input {
  flex: 1;
  background-color: #1e1e1e;
  color: #ffffff;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  outline: none;
  font-size: 16px;
  margin-right: 10px;
}

.footer button {
  background-color: #3b4252;
  color: #ffffff;
  border: none;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}

.footer button#attachment {
  background-color: #3592bd;
}

.footer button:hover {
  background-color: #4f5b66;
}

</style>
 <script>

const toggleButton = document.getElementById('toggle-btn');
const sidebar = document.getElementById('sidebar');

function toggleSidebar () {
  sidebar.classList.toggle('close');
}
  $(document).ready(function () {
  const API_KEY = "AIzaSyAzAPuf5mx2XfPryaCbAtNuBctX-5i3MnQ"; // Replace this with your actual Gemini API Key

  // Send message when clicking the send button
  $("#send").click(function () {
      sendMessage();
  });

  // Send message when pressing "Enter"
  $("#text").keypress(function (event) {
      if (event.which === 13) {
          sendMessage();
      }
  });

  // Open file input when clicking the attachment button
  $("#attachment").click(function () {
      $("#fileInput").click();
  });

  // Handle file selection
  $("#fileInput").change(function () {
      const file = this.files[0];
      if (file) {
          appendMessage("user", "üìé Attachment: " + file.name);
      }
  });

  // Handle "How the Calculation Works" button
  $("#howCalculationWorks").click(function () {
      const explanation = "**‚ö° How the Electricity Calculation Works:**\n\n" +
          "üîπ **1Ô∏è‚É£ Separate House Billing (Per House Calculation)**\n" +
          "   - **Step 1:** Compute the total kWh used by the **Primary Meter**:\n" +
          "     üìå `Primary Present Reading - Primary Previous Reading`\n" +
          "   - **Step 2:** Compute the kWh used by each **Submeter**:\n" +
          "     üìå `Submeter Present Reading - Submeter Previous Reading`\n" +
          "   - **Step 3:** Compute the **Cost per kWh**:\n" +
          "     üìå `Total Bill of Primary Meter √∑ Total kWh Used of Primary Meter`\n" +
          "   - **Step 4:** Compute the **Submeter Bill (Peso)**:\n" +
          "     üìå `Cost per kWh √ó kWh Used by Submeter`\n\n" +
          "üîπ **2Ô∏è‚É£ Household Cost Sharing (Splitting Among Tenants in One House)**\n" +
          "   - **Method 1: Equal Share**\n" +
          "     üìå `Total House Bill √∑ Number of Tenants`\n" +
          "   - **Method 2: Individual Metered Usage**\n" +
          "     üìå `(Tenant kWh √∑ House kWh) √ó Total House Bill`\n\n" +
          "üí° *This ensures a fair and transparent cost-sharing system!*";

      appendMessage("model", explanation);
  });

  // Function to send user input
  function sendMessage() {
      const userMessage = $("#text").val().trim();
      if (userMessage !== "") {
          appendMessage("user", userMessage);
          $("#text").val(""); // Clear input field
          fetchGeminiResponse(userMessage);
      }
  }

  // Function to append messages to chat
  function appendMessage(sender, text) {
      const messageContainer = $("#chatContainer");
      const messageDiv = $("<div>").addClass("message " + sender);
      const messageBody = $("<div>").addClass("msg-body").text(text);

      messageDiv.append(messageBody);
      messageContainer.append(messageDiv);
      messageContainer.scrollTop(messageContainer.prop("scrollHeight"));
  }

  // Function to call Gemini AI API
  async function fetchGeminiResponse(userInput) {
      try {
          const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=" + API_KEY, {
              method: "POST",
              headers: {
                  "Content-Type": "application/json"
              },
              body: JSON.stringify({
                  contents: [{ role: "user", parts: [{ text: userInput }] }]
              })
          });

          const data = await response.json();
          const botReply = data.candidates[0].content.parts[0].text || "ü§ñ I couldn't understand that.";

          appendMessage("model", botReply);
      } catch (error) {
          appendMessage("model", "‚ùå Error: Unable to fetch response.");
          console.error("Error fetching Gemini AI response:", error);
      }
  }
});

 </script>

  
</body>
</html>
